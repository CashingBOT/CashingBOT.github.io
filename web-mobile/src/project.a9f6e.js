window.__require=function t(e,n,o){function a(c,i){if(!n[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var u="function"==typeof __require&&__require;if(!i&&u)return u(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var l=n[c]={exports:{}};e[c][0].call(l.exports,function(t){return a(e[c][1][t]||t)},l,l.exports,t,e,n,o)}return n[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<o.length;c++)a(o[c]);return a}({DataManager:[function(t,e,n){"use strict";cc._RF.push(e,"640ccytEzdOZbU9qPGhshTa","DataManager");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(t,e,n,o){var a,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var i=t.length-1;i>=0;i--)(a=t[i])&&(c=(r<3?a(c):r>3?a(e,n,c):a(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator.ccclass,c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.touchLayer=null,e.player=null,e.fireLock=null,e.moveLock=null,e=a([r],e)}(cc.Component);n.default=c,cc._RF.pop()},{}],EventManager:[function(t,e,n){"use strict";cc._RF.push(e,"da6366cLDVPPakKEq9kbPLu","EventManager"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.emitSystemEvent=function(t){var e=this.eventsMap.get(t),n=e.callback,o=e.target;n.call(o)},t.systemEventOn=function(e){return function(n,o,a){t.eventsMap.has(e)&&console.warn(e.toString()+" \u4e8b\u4ef6\u5df2\u5b58\u5728\uff0c\u8986\u76d6");var r=a.value;t.eventsMap.set(e,{callback:r,target:n})}},t.systemEventOff=function(t){this.eventsMap.has(t)?this.eventsMap.delete(t):console.warn(t.toString()+" \u4e8b\u4ef6\u4e0d\u5b58\u5728")},t.MOVE_ON=Symbol(),t.MOVE_OFF=Symbol(),t.FIRE_ON=Symbol(),t.FIRE_OFF=Symbol(),t.eventsMap=new Map,t}();n.default=o,cc._RF.pop()},{}],FireSystem:[function(t,e,n){"use strict";cc._RF.push(e,"cccf3CqvURKFJVuLYRNVabW","FireSystem");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(t,e,n,o){var a,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var i=t.length-1;i>=0;i--)(a=t[i])&&(c=(r<3?a(c):r>3?a(e,n,c):a(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../managers/DataManager"),c=cc._decorator.ccclass,i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SHAPE=cc.Enum({TRIANGLE:"triangle"}),e.INTERVAL=.1,e.SPEED=1e3,e.DISTANCE_LEVEL_1=100,e.DISTANCE_LEVEL_2=200,e.DISTANCE_LEVEL_3=300,e.nodeName=null,e.nodeScaleX=null,e.nodeScaleY=null,e.nodeScale=null,e.counter=0,e}return o(e,t),e.prototype.onEnable=function(){this.nodeName=this.node.name.replace("box_",""),this.nodeScaleX=this.node.scaleX,this.nodeScaleY=this.node.scaleY,this.nodeScale=this.nodeScaleX*this.nodeScaleY,this.startFire()},e.prototype.onDisable=function(){if(!r.default.fireLock)switch(this.nodeName){case this.SHAPE.TRIANGLE:this.finishTri()}},e.prototype.startFire=function(){switch(this.nodeName){case this.SHAPE.TRIANGLE:this.schedule(this.triangleSkill,this.INTERVAL,20)}},e.prototype.triangleSkill=function(){this.node.scaleY+=.05,this.node.scaleX=this.nodeScale/this.node.scaleY,this.counter+=this.INTERVAL},e.prototype.finishTri=function(){this.unschedule(this.triangleSkill);var t=null;this.counter<1?t=this.DISTANCE_LEVEL_1:this.counter>=1&&this.counter<2?t=this.DISTANCE_LEVEL_2:this.counter>=2&&(t=this.DISTANCE_LEVEL_3);var e=t/this.SPEED,n=cc.misc.degreesToRadians(r.default.player.angle),o=-Math.sin(n)*t,a=Math.cos(n)*t;cc.tween(this.node).by(e,{position:cc.v2(o,a)}).start(),this.node.scaleX=this.nodeScaleX,this.node.scaleY=this.nodeScaleY,this.counter=0},e=a([c],e)}(cc.Component);n.default=i,cc._RF.pop()},{"../managers/DataManager":"DataManager"}],MainManager:[function(t,e,n){"use strict";cc._RF.push(e,"8c597KnuTlL6JfA+C8CaN0M","MainManager");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(t,e,n,o){var a,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var i=t.length-1;i>=0;i--)(a=t[i])&&(c=(r<3?a(c):r>3?a(e,n,c):a(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./DataManager"),c=t("./EventManager"),i=t("../systems/TouchSystem"),s=t("../systems/FireSystem"),u=cc._decorator,l=u.ccclass,f=u.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.touchLayer=null,e.player=null,e}return o(e,t),e.prototype.start=function(){this.initData(),this.addComp()},e.prototype.initData=function(){r.default.touchLayer=this.touchLayer,r.default.player=this.player,r.default.moveLock=!1,r.default.fireLock=!0},e.prototype.addComp=function(){r.default.touchLayer.addComponent(i.default).enabled=!0,r.default.player.addComponent(s.default).enabled=!1},e.prototype.touchOn=function(){r.default.player.getComponent(s.default).enabled=!1,r.default.moveLock=!1,r.default.fireLock=!0},e.prototype.fireOn=function(){r.default.player.getComponent(s.default).enabled=!0,r.default.moveLock=!0,r.default.fireLock=!1},a([f(cc.Node)],e.prototype,"touchLayer",void 0),a([f(cc.Node)],e.prototype,"player",void 0),a([c.default.systemEventOn(c.default.MOVE_ON)],e.prototype,"touchOn",null),a([c.default.systemEventOn(c.default.MOVE_OFF)],e.prototype,"fireOn",null),e=a([l],e)}(cc.Component);n.default=p,cc._RF.pop()},{"../systems/FireSystem":"FireSystem","../systems/TouchSystem":"TouchSystem","./DataManager":"DataManager","./EventManager":"EventManager"}],TouchSystem:[function(t,e,n){"use strict";cc._RF.push(e,"ae5576GapJI86n+JK1CF2Ur","TouchSystem");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(t,e,n,o){var a,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var i=t.length-1;i>=0;i--)(a=t[i])&&(c=(r<3?a(c):r>3?a(e,n,c):a(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../managers/DataManager"),c=t("../managers/EventManager"),i=cc._decorator.ccclass,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SPEED=1e3,e.time=null,e.distance=null,e.deltaX=null,e.deltaY=null,e.touchPos=null,e.isStart=!1,e.isMove=!1,e.isRotate=!1,e}return o(e,t),e.prototype.onEnable=function(){var t=this;this.node.hasEventListener(cc.Node.EventType.TOUCH_START)||this.node.on(cc.Node.EventType.TOUCH_START,function(){t.scheduleOnce(t.emitMsg,.1)}),this.node.hasEventListener(cc.Node.EventType.TOUCH_MOVE)||this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){0!==e.getDelta().x&&0!==e.getDelta().y&&(t.unschedule(t.emitMsg),t.calcParam(e),t.isStart=!0,!1===r.default.moveLock?t.isMove=!0:t.isMove=!1,t.isRotate=!0)}),this.node.hasEventListener(cc.Node.EventType.TOUCH_CANCEL)||this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){c.default.emitSystemEvent(c.default.MOVE_ON),t.unschedule(t.emitMsg)}),this.node.hasEventListener(cc.Node.EventType.TOUCH_END)||this.node.on(cc.Node.EventType.TOUCH_END,function(){c.default.emitSystemEvent(c.default.MOVE_ON),t.unschedule(t.emitMsg),t.isStart=!1,t.isMove=!1,t.isRotate=!1})},e.prototype.update=function(t){if(this.isStart){var e=r.default.player.x-this.touchPos.x,n=r.default.player.y-this.touchPos.y;this.isMove&&this.move(t,e,n),this.isRotate&&this.rotate(e,n)}},e.prototype.emitMsg=function(){c.default.emitSystemEvent(c.default.MOVE_OFF)},e.prototype.calcParam=function(t){var e=r.default.player.parent.convertToWorldSpaceAR(r.default.player.position);this.touchPos=r.default.player.parent.convertToNodeSpaceAR(t.getLocation()),this.deltaX=t.getLocationX()-e.x,this.deltaY=t.getLocationY()-e.y,this.distance=Math.sqrt(Math.pow(this.deltaX,2)+Math.pow(this.deltaY,2)),this.time=this.distance/this.SPEED},e.prototype.move=function(t,e,n){var o=Math.abs(e),a=Math.abs(n),c=this.time/t,i=this.deltaX/c,s=this.deltaY/c;r.default.player.x+=i,r.default.player.y+=s,o<=10&&a<=10&&(this.isMove=!1,r.default.player.x=this.touchPos.x,r.default.player.y=this.touchPos.y)},e.prototype.rotate=function(t,e){var n=Math.atan2(e,t),o=cc.misc.radiansToDegrees(n);o+=90,r.default.player.angle=o},e=a([i],e)}(cc.Component);n.default=s,cc._RF.pop()},{"../managers/DataManager":"DataManager","../managers/EventManager":"EventManager"}]},{},["DataManager","EventManager","MainManager","FireSystem","TouchSystem"]);